ARG DATABASE_URL
ARG CLOUDINARY_CLOUD_NAME
ARG CLOUDINARY_API_KEY
ARG CLOUDINARY_API_SECRET
ARG SITE_URL

FROM node:22-bullseye-slim

WORKDIR /app

COPY package.json ./

RUN npm i

COPY . .

ENV DATABASE_URL=${DATABASE_URL}
ENV CLOUDINARY_CLOUD_NAME=${CLOUDINARY_CLOUD_NAME}
ENV CLOUDINARY_API_KEY=${CLOUDINARY_API_KEY}
ENV CLOUDINARY_API_SECRET=${CLOUDINARY_API_SECRET}
ENV SITE_URL=${SITE_URL}

EXPOSE 4000

CMD [ "npm", "run", "start" ]